/*!
 * @copyright &copy; Kartik Visweswaran, Krajee.com, 2014 - 2015
 * @version 1.4.1
 *
 * A multi level dependent dropdown JQuery plugin. The plugin
 * allows nested and combined dependencies.
 * 
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */!function(e){"use strict";var t=function(t,a){return null===t||void 0===t||0===t.length||a&&""===e.trim(t)},a=function(t,a,n,i){var d={value:a,text:n};a===i&&null!==i&&(d.selected="selected"),e("<option/>",d).appendTo(t)},n=function(e,t){var a,n,i,d={};if(0===e.length)return{};for(a=0;a<e.length;a++)n=e[a],i=t[a],d[n]=i;return d},i=function(t,a){var n=this;n.$element=e(t),e.each(a,function(e,t){n[e]=t}),n.initData(),n.init()};i.prototype={constructor:i,initData:function(){var e=this,t=e.$element;t.data("url",e.url).data("depends",e.depends).data("placeholder",e.placeholder).data("loading",e.loading).data("loadingClass",e.loadingClass).data("loadingText",e.loadingText).data("emptyMsg",e.emptyMsg).data("initialize",e.initialize).data("params",e.params)},init:function(){var t,a=this,n=a.depends,i=a.$element,d=n.length,r={},o=i.find("option").length,l=function(e){return function(){a.setDep(e,n,d,!1)}};(0===o||i.find('option[value=""]').length===o)&&i.attr("disabled","disabled");for(var p=0;d>p;p++)t=e("#"+n[p]),t.on("change",l(t));if(a.initialize===!0){for(var s=0;d>s;s++)s>0&&(r[s]=e("#"+n[s]).val());n[d]=i.attr("id"),r[d]=i.val(),e(document).ready(function(){a.initDep(0,n,r)})}i.trigger("depdrop.init")},setDep:function(t,a,n,i){for(var d,r,o=this,l=o.$element,p={},s=i,c=function(){l.trigger("change")},u=0;n>u;u++)d=e("#"+a[u]),r=d.attr("type"),p[u]="checkbox"===r||"radio"===r?d.prop("checked"):d.val();o.processDep(l,t.attr("id"),p,s,c,a)},initDep:function(t,a,n){var i,d=this,r={},o=n[t+1],l=e("#"+a[t+1]),p=l.attr("id"),s=a.length,c=function(){d.initDep(t+1,a,n)};for(i=0;t>=i;i++)r[i]=e("#"+a[i]).val();s-1>t&&d.processDep(l,p,r,o,c,a)},processDep:function(i,d,r,o,l,p){var s,c,u,f,g,h=this,v=0,m={},y={depdrop_parents:r},b=n(p,r),C={},D=i.data("url"),x=i.data("placeholder"),T=i.data("loading"),_=i.data("loadingClass"),j=i.data("loadingText"),z=i.data("emptyMsg"),M=i.data("params");if(!t(M)){for(u=0;u<M.length;u++)f=M[u],g=e("#"+M[u]).val(),m[u]=g,C[f]=g;y={depdrop_parents:r,depdrop_params:m}}y.depdrop_all_params=e.extend(b,C),c={url:D,type:"post",data:y,dataType:"json",success:function(n){s=o===!1?t(n.selected)?null:n.selected:o,t(n)?a(i,"",z,""):(i.html(h.getSelect(n.output,x,s)),i.find("optgroup").length>0&&i.find('option[value=""]').attr("disabled","disabled"),0!==n.output.length&&i.val(s).removeAttr("disabled")),v=i.find("option").length,i.find('option[value=""]').length>0&&(v-=1),i.trigger("depdrop.change",[d,e("#"+d).val(),v,o])}},c.beforeSend=function(){i.trigger("depdrop.beforeChange",[d,e("#"+d).val(),o]),i.attr("disabled","disabled").html(""),T&&i.removeClass(_).addClass(_).html('<option id="">'+j+"</option>")},c.error=function(){i.trigger("depdrop.error",[d,e("#"+d).val(),o])},c.complete=function(){l(),T&&i.removeClass(_),i.trigger("depdrop.afterChange",[d,e("#"+d).val(),o])},e.ajax(c)},getSelect:function(n,i,d){var r=this,o=e("<select>"),l=r.idParam,p=r.nameParam;return i!==!1&&a(o,"",i,d),t(n)&&(n={}),e.each(n,function(t,n){if(n[l])a(o,n[l],n[p],d);else{var i=e("<optgroup>",{label:t});e.each(n,function(e,t){a(i,t[l],t[p],d)}),i.appendTo(o)}}),o.html()}},e.fn.depdrop=function(t){var a=Array.apply(null,arguments);return a.shift(),this.each(function(){var n=e(this),d=n.data("depdrop"),r="object"==typeof t&&t;d||(d=new i(this,e.extend({},e.fn.depdrop.defaults,r,e(this).data())),n.data("depdrop",d)),"string"==typeof t&&d[t].apply(d,a)})},e.fn.depdrop.defaults={url:"",loading:!0,loadingClass:"kv-loading",loadingText:"Loading ...",placeholder:"Select ...",emptyMsg:"No data found",initialize:!1,idParam:"id",nameParam:"name",params:{}},e.fn.depdrop.Constructor=i,e(function(){e("select.depdrop").depdrop()})}(window.jQuery);